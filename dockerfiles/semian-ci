FROM ruby:2.6.3

ENV DEBIAN_FRONTEND=noninteractive

RUN apt-get update \
    && apt-get install -y build-essential libssl-dev netcat

RUN gem install bundler

WORKDIR /home/travis/build/Shopify/semian
COPY . .
ARG BUNDLE_GEMFILE
ENV BUNDLE_GEMFILE="${BUNDLE_GEMFILE}"

ARG SEMIAN_CIRCUIT_BREAKER_IMPL
ENV SEMIAN_CIRCUIT_BREAKER_IMPL="${SEMIAN_CIRCUIT_BREAKER_IMPL}"
