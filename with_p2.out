============================================================
Adaptive Circuit Breaker with Net::HTTP Example
============================================================

Configuring Semian with adaptive circuit breaker...
Configuration complete!

Phase 1: Normal operation (successful requests)
----------------------------------------
Request 1: Success (HTTP 404)
Request 2: Success (HTTP 200)
Request 3: Success (HTTP 200)
Request 4: Success (HTTP 200)
Request 5: Success (HTTP 200)
Request 6: Success (HTTP 200)
Request 7: Success (HTTP 200)
Request 8: Success (HTTP 200)
Request 9: Success (HTTP 200)
Request 10: Success (HTTP 200)
Request 11: Success (HTTP 200)
Request 12: Success (HTTP 200)
Request 13: Success (HTTP 200)
Request 14: Success (HTTP 200)
Request 15: Success (HTTP 200)
Request 16: Success (HTTP 200)
Request 17: Success (HTTP 200)
Request 18: Success (HTTP 200)
Request 19: Success (HTTP 200)
Request 20: Success (HTTP 200)
Request 21: Success (HTTP 200)
Request 22: Success (HTTP 200)
Request 23: Success (HTTP 200)
Request 24: Success (HTTP 200)
Request 25: Success (HTTP 200)
Request 26: Success (HTTP 200)
Request 27: Success (HTTP 200)
Request 28: Success (HTTP 200)
Request 29: Success (HTTP 200)
Request 30: Success (HTTP 200)
Request 31: Success (HTTP 200)
Request 32: Success (HTTP 200)
Request 33: Success (HTTP 200)
Request 34: Success (HTTP 200)
Request 35: Success (HTTP 200)
Request 36: Success (HTTP 200)
Request 37: Success (HTTP 200)
Request 38: Success (HTTP 404)
Request 39: Success (HTTP 200)
Request 40: Success (HTTP 200)
Request 41: Success (HTTP 200)
Request 42: Success (HTTP 200)
Request 43: Success (HTTP 200)
Request 44: Success (HTTP 200)
Request 45: Success (HTTP 200)
Request 46: Success (HTTP 200)
Request 47: Success (HTTP 200)
Request 48: Success (HTTP 200)
Request 49: Success (HTTP 200)
Request 50: Success (HTTP 200)
Request 51: Success (HTTP 200)
Request 52: Success (HTTP 200)
Request 53: Success (HTTP 200)
Request 54: Success (HTTP 200)
Request 55: Success (HTTP 200)
Request 56: Success (HTTP 200)
Request 57: Success (HTTP 200)
Request 58: Success (HTTP 200)
Request 59: Success (HTTP 200)
Request 60: Success (HTTP 200)

Phase 2: Simulating errors (requesting error status codes)
----------------------------------------
Request 1: Got HTTP 503
Request 2: Got HTTP 503
Request 3: Got HTTP 503
Request 4: Got HTTP 503
Request 5: Got HTTP 503
Request 6: Got HTTP 503
Request 7: Got HTTP 503
Request 8: Got HTTP 503
Request 9: Got HTTP 503
Request 10: Got HTTP 503
Request 11: Got HTTP 503
Request 12: Got HTTP 503
Request 13: Got HTTP 503
Request 14: Got HTTP 503
Request 15: Got HTTP 503
Request 16: Got HTTP 503
Request 17: Error - Net::CircuitOpenError: [nethttp_localhost_80] Rejected by adaptive circuit breaker (rejection_rate: 0.3927888888888889) caused by SERVICE UNAVAILABLE
Request 18: Error - Net::CircuitOpenError: [nethttp_localhost_80] Rejected by adaptive circuit breaker (rejection_rate: 0.3927888888888889) caused by SERVICE UNAVAILABLE
Request 19: Error - Net::CircuitOpenError: [nethttp_localhost_80] Rejected by adaptive circuit breaker (rejection_rate: 0.3927888888888889) caused by SERVICE UNAVAILABLE
Request 20: Error - Net::CircuitOpenError: [nethttp_localhost_80] Rejected by adaptive circuit breaker (rejection_rate: 0.3927888888888889) caused by SERVICE UNAVAILABLE
Request 21: Error - Net::CircuitOpenError: [nethttp_localhost_80] Rejected by adaptive circuit breaker (rejection_rate: 0.3927888888888889) caused by SERVICE UNAVAILABLE
Request 22: Got HTTP 503
Request 23: Error - Net::CircuitOpenError: [nethttp_localhost_80] Rejected by adaptive circuit breaker (rejection_rate: 0.3927888888888889) caused by SERVICE UNAVAILABLE
Request 24: Got HTTP 503
Request 25: Error - Net::CircuitOpenError: [nethttp_localhost_80] Rejected by adaptive circuit breaker (rejection_rate: 0.3927888888888889) caused by SERVICE UNAVAILABLE
Request 26: Error - Net::CircuitOpenError: [nethttp_localhost_80] Rejected by adaptive circuit breaker (rejection_rate: 0.3927888888888889) caused by SERVICE UNAVAILABLE
Request 27: Error - Net::CircuitOpenError: [nethttp_localhost_80] Rejected by adaptive circuit breaker (rejection_rate: 0.3927888888888889) caused by SERVICE UNAVAILABLE
Request 28: Error - Net::CircuitOpenError: [nethttp_localhost_80] Rejected by adaptive circuit breaker (rejection_rate: 0.3927888888888889) caused by SERVICE UNAVAILABLE
Request 29: Got HTTP 503
Request 30: Error - Net::CircuitOpenError: [nethttp_localhost_80] Rejected by adaptive circuit breaker (rejection_rate: 0.3927888888888889) caused by SERVICE UNAVAILABLE
Request 31: Error - Net::CircuitOpenError: [nethttp_localhost_80] Rejected by adaptive circuit breaker (rejection_rate: 0.3927888888888889) caused by SERVICE UNAVAILABLE
Request 32: Error - Net::CircuitOpenError: [nethttp_localhost_80] Rejected by adaptive circuit breaker (rejection_rate: 0.3927888888888889) caused by SERVICE UNAVAILABLE
Request 33: Error - Net::CircuitOpenError: [nethttp_localhost_80] Rejected by adaptive circuit breaker (rejection_rate: 0.3927888888888889) caused by SERVICE UNAVAILABLE
Request 34: Error - Net::CircuitOpenError: [nethttp_localhost_80] Rejected by adaptive circuit breaker (rejection_rate: 0.3927888888888889) caused by SERVICE UNAVAILABLE
Request 35: Error - Net::CircuitOpenError: [nethttp_localhost_80] Rejected by adaptive circuit breaker (rejection_rate: 0.3927888888888889) caused by SERVICE UNAVAILABLE
Request 36: Error - Net::CircuitOpenError: [nethttp_localhost_80] Rejected by adaptive circuit breaker (rejection_rate: 0.3927888888888889) caused by SERVICE UNAVAILABLE
Request 37: Got HTTP 503
Request 38: Got HTTP 503
Request 39: Got HTTP 503
Request 40: Got HTTP 503
Request 41: Got HTTP 503
Request 42: Got HTTP 503
Request 43: Got HTTP 503
Request 44: Got HTTP 503
Request 45: Got HTTP 503
Request 46: Got HTTP 503
Request 47: Got HTTP 503
Request 48: Got HTTP 503
Request 49: Got HTTP 503
Request 50: Got HTTP 503
Request 51: Got HTTP 503
Request 52: Got HTTP 503
Request 53: Got HTTP 503
Request 54: Got HTTP 503
Request 55: Got HTTP 503
Request 56: Error - Net::CircuitOpenError: [nethttp_localhost_80] Rejected by adaptive circuit breaker (rejection_rate: 0.5583126962962962) caused by SERVICE UNAVAILABLE
Request 57: Error - Net::CircuitOpenError: [nethttp_localhost_80] Rejected by adaptive circuit breaker (rejection_rate: 0.5583126962962962) caused by SERVICE UNAVAILABLE
Request 58: Error - Net::CircuitOpenError: [nethttp_localhost_80] Rejected by adaptive circuit breaker (rejection_rate: 0.5583126962962962) caused by SERVICE UNAVAILABLE
Request 59: Error - Net::CircuitOpenError: [nethttp_localhost_80] Rejected by adaptive circuit breaker (rejection_rate: 0.5583126962962962) caused by SERVICE UNAVAILABLE
Request 60: Error - Net::CircuitOpenError: [nethttp_localhost_80] Rejected by adaptive circuit breaker (rejection_rate: 0.5583126962962962) caused by SERVICE UNAVAILABLE

Phase 3: Recovery (back to successful requests)
----------------------------------------
Request 1: Error - Net::CircuitOpenError: [nethttp_localhost_80] Rejected by adaptive circuit breaker (rejection_rate: 0.5583126962962962) caused by SERVICE UNAVAILABLE
Request 2: Error - Net::CircuitOpenError: [nethttp_localhost_80] Rejected by adaptive circuit breaker (rejection_rate: 0.5583126962962962) caused by SERVICE UNAVAILABLE
Request 3: Error - Net::CircuitOpenError: [nethttp_localhost_80] Rejected by adaptive circuit breaker (rejection_rate: 0.5583126962962962) caused by SERVICE UNAVAILABLE
Request 4: Success (HTTP 200)
Request 5: Error - Net::CircuitOpenError: [nethttp_localhost_80] Rejected by adaptive circuit breaker (rejection_rate: 0.5583126962962962) caused by SERVICE UNAVAILABLE
Request 6: Error - Net::CircuitOpenError: [nethttp_localhost_80] Rejected by adaptive circuit breaker (rejection_rate: 0.5583126962962962) caused by SERVICE UNAVAILABLE
Request 7: Success (HTTP 200)
Request 8: Success (HTTP 200)
Request 9: Error - Net::CircuitOpenError: [nethttp_localhost_80] Rejected by adaptive circuit breaker (rejection_rate: 0.5583126962962962) caused by SERVICE UNAVAILABLE
Request 10: Error - Net::CircuitOpenError: [nethttp_localhost_80] Rejected by adaptive circuit breaker (rejection_rate: 0.5583126962962962) caused by SERVICE UNAVAILABLE
Request 11: Error - Net::CircuitOpenError: [nethttp_localhost_80] Rejected by adaptive circuit breaker (rejection_rate: 0.5583126962962962) caused by SERVICE UNAVAILABLE
Request 12: Error - Net::CircuitOpenError: [nethttp_localhost_80] Rejected by adaptive circuit breaker (rejection_rate: 0.5583126962962962) caused by SERVICE UNAVAILABLE
Request 13: Error - Net::CircuitOpenError: [nethttp_localhost_80] Rejected by adaptive circuit breaker (rejection_rate: 0.5583126962962962) caused by SERVICE UNAVAILABLE
Request 14: Error - Net::CircuitOpenError: [nethttp_localhost_80] Rejected by adaptive circuit breaker (rejection_rate: 0.5583126962962962) caused by SERVICE UNAVAILABLE
Request 15: Success (HTTP 200)
Request 16: Success (HTTP 200)
Request 17: Success (HTTP 200)
Request 18: Success (HTTP 200)
Request 19: Success (HTTP 200)
Request 20: Success (HTTP 200)
Request 21: Success (HTTP 200)
Request 22: Success (HTTP 200)
Request 23: Success (HTTP 200)
Request 24: Success (HTTP 200)
Request 25: Success (HTTP 200)
Request 26: Success (HTTP 200)
Request 27: Success (HTTP 200)
Request 28: Success (HTTP 200)
Request 29: Success (HTTP 200)
Request 30: Success (HTTP 200)
Request 31: Success (HTTP 200)
Request 32: Success (HTTP 200)
Request 33: Success (HTTP 200)
Request 34: Success (HTTP 200)
Request 35: Success (HTTP 200)
Request 36: Success (HTTP 200)
Request 37: Success (HTTP 200)
Request 38: Success (HTTP 200)
Request 39: Success (HTTP 200)
Request 40: Success (HTTP 200)
Request 41: Success (HTTP 200)
Request 42: Success (HTTP 200)
Request 43: Success (HTTP 200)
Request 44: Success (HTTP 200)
Request 45: Success (HTTP 200)
Request 46: Success (HTTP 200)
Request 47: Success (HTTP 200)
Request 48: Success (HTTP 200)
Request 49: Success (HTTP 200)
Request 50: Success (HTTP 200)
Request 51: Success (HTTP 200)
Request 52: Success (HTTP 200)
Request 53: Success (HTTP 200)
Request 54: Success (HTTP 200)
Request 55: Success (HTTP 200)
Request 56: Success (HTTP 200)
Request 57: Success (HTTP 200)
Request 58: Success (HTTP 200)
Request 59: Success (HTTP 200)
Request 60: Success (HTTP 200)

============================================================
Example complete!
============================================================

Key Points:
- The adaptive circuit breaker works seamlessly with existing adapters
- It monitors request success/failure rates automatically
- Background health checks help detect recovery
- The rejection rate adjusts dynamically based on service health
